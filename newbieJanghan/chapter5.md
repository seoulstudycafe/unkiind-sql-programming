# SELECT 문

> 기본 구성
> keyword -> clause -> statement
> ---
> SELECT 절  
> FROM 절
> ---

## SELECT 절
### asterisk
### describe [table]
### column
### column alias
### DISTINCT keyword
- 기본 값은 `ALL`: 중복 값 제거하지 않는다
- `DISTINCT` || `UNIQUE`: 중복 값 제거

## FROM 절
### schema
- 스키마를 지정하지 않으면 현재 사용자의 테이블, 전용 Synonym, 공용 Synonym 순으로 구문이 해석된다.
### table alias
- error `열의 정의가 애매합니다.`
### SAMPLE clause
- 테이블 샘플링하여 조회
- 대용량 테이블에 대한 통계 값을 생성할 때 활용할 수 있다.

    ``` oracle
    SAMPLE [BLOCK] (sample_percent) [SEED (seed_value)]
    ```
  
#### 블록 샘플링 (Block Sampling)
- Oracle에서 데이터는 물리적으로 데이터 블록이라는 기본 저장 단위로 관리됩니다. 이 블록은 여러 행(row)을 포함할 수 있습니다.
- 테이블에서 임의의 블록을 선택한 다음, 선택된 블록에 포함된 모든 행을 추출합니다. 따라서 특정 블록이 선택되면 그 블록에 속한 모든 행이 함께 선택됩니다.
- 블록 단위로 데이터를 추출하므로 성능이 상대적으로 빠릅니다. 
- 테이블의 크기가 매우 클 때 유용할 수 있습니다. 
- 균등한 샘플링이 보장되지 않을 수 있음: 한 블록에 많은 행이 있고, 다른 블록에 적은 행이 있을 수 있기 때문에 행의 비율이 일정하지 않을 수 있습니다. 
- 용 시기: 성능을 중시하고, 행 단위보다는 전체 블록에서 표본을 추출하고자 할 때.

## 기본 요소
### 리터럴
> 변하지 않는 값
> 전체 행에서 동일한 값을 반환한다.

#### 문자 리터럴
- 작은 따옴표로 기술하거나, 10.1 버전부터 `q'[문자열]'` 의ㅣ quote_delimiter 를 활용한 인용 방식을 쓸 수 있다.
- quote_delimiter 는 [], {}, <>, () 등 사용
- 사례
  ```oracle
        SELECT q'[2'B]' AS c1, q'{[3c]}' as c2 FROM DUAL;
  ```
- DUAL 테이블
  - dummy 열로 구성되며 1개 행을 가지고 있다. 
  - 리터럴 조회, 행 복제 등의 용도로 사용 됨.

#### 숫자 리터럴
- 그냥 숫자 그대로 표기하는 방법.
- `E`는 과학적 표기법으로, 정수부에 10진수 지수 값을 E옆에 작성한다. (`3.4E2` = 340)
- COLUMN 명령어 (`COL`)
  - FORMAT (`FOR`) 키워드와 함께 해당 열의 출력 포맷을 설정할 수 있다.
  - 필요할 때 마다 검색해서 기억하자. 
  - 숫자 열은 0, 9, 구분자(,), 소수점(.) 을 활용한다.
  - 문자 열은 `A1`, `A2` 와 같이 길이를 조절할 수 있다. 값의 길이가 포맷보다 작으면, 포맷 남은 부분은 빈칸으로. 길이가 포맷보다 크면 짤려서.

#### 날짜 리터럴
- NLS 파라미터: National Language Support. 날짜 값 포맷은 NLS 파라미터로 설정할 수 있다.
- `DATE`, `TIMESTAMP`, `TIMESTAMP WITH TIME ZONE`

#### 인터벌 리터럴
- `YEAR TO MONTH`, `DAY TO SECOND`
- 각 키워드의 `TO ~`는 생략 가능하다. 표현하고자 하는 시간 간격을 보다 작은 단위에서 사용하기 위한 것.

### 널(NULL)
### 연산자(Operator)
> 산술 연산자, 연결 연산자 는 이번 챕터에서  
> 집합 연산자, 계층 쿼리 연산자, MULTISET 연산자는 이후 챕터에서
#### 산술 연산자
- 나눗셈 연산자의 제수(분모)가 0이면 에러.
- 날짜 값 산술은 기본적으로 일 단위로 연산.
```oracle
SELECT DATE '2050-01-31' + (1 / 24 / 60 / 60) as C1,
       DATE '2050-01-31' + INTERVAL '1' SECOND as C2
FROM dual;
```
> c1 = c2 == 2050-01-31 00:00:01. 둘 다 1초 씩 더해짐  
인터벌 리터럴 표현이 엄청 직관적임을 알 수 있다.
- 월 연산은 `ADD_MONTHS()` 사용. 달 마다 마지막 일자가 다르기 때문에, 리터럴로 계산하기 어려움.
- 산술 연산에 null 사용하면 널이 반환된다.

#### 연결 연산자
- `||`로 문자열을 연결한다.
- 산술 연산자보다 연산의 우선순위가 낮다.

### 표현식
- 값으로 평가될 수 있는 리터럴, 연산자, SQL 함수 등의 조합.
- 대표적으로 CASE. CASE 표현식을 사용하면 IF THEN ELSE 논리를 평가할 수 있다.

### pseudo column
- 테이블에 저장되지 않은 의사 컬럼, 쿼리 수행 시점에 값이 결정된다.
- 대표적으로 `ROWID`
  - 행이 저장된 주소를 반환한다.
  - 데이터 오브젝트 번호 6자리 + 상대적 파일 번호 3자리 + 블록 번호 6자리 + 블록 내 행 번호 3자리

### 주석
#### 힌트
- 옵티마이저에 명령을 전달한느 특별한 주석
- 20장 참고


## 바인드 변수
- 쿼리의 재사용성을 높일 수 있다.
```oracle
VAR v1 NUMBER; -- 변수 선언
EXEC :v1 := 1; -- 값 할당
SELECT :v1 AS c1 FROM dual; -- c1 = 1

EXEC :v1 := 2;
SELECT :v2 AS c1 FROM dual; -- c1 = 1;

-- 12.1 버전부터 변수 선언하면서 동시에 값을 할당할 수 있음
VAR b1 NUMBER = 3;
```
